<!DOCTYPE html>
<html lang="en">
<head>
        <title>Shane Dowling : Generate Binary Tree From String</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
        <link href="https://shanedowling.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Shane Dowling ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body>
        
<header>
    <h1><a href="." id="site-title">Shane Dowling </a> :
        <a href="./generate-binary-tree-from-string-fcb1a0c662e7.html" id="page-title">Generate Binary Tree From String</a></h1>
<time datetime="2015-10-27T00:00:00+00:00">Tue 27 October 2015</time></header>
<article>
    <p>Recently while implementing the <a href="http://rosalind.info/problems/ba7f/">Small Parsimony Problem</a> I had the need to generate a binary tree from a string in Python.</p>
<p>The pseudo-code in the question implicitly assumes you have some functionality that will generate a DNA sequence like CAAATCCC into a binary tree, then run SmallParsimony on it. I couldn't find that functionality anywhere, so I decided to implement something simple in networkx. Hopefully it's useful.</p>
<p>```python</p>
<h1>!/usr/bin/env python</h1>
<p>"""
 Shane Dowling, 27 Oct 2015
 To run simply call generate_leaf_graph and pass in s string.
 """
def count_predecessors(T):
 pred = 0
 for v in T.nodes():
 pred += 1
 return pred</p>
<p>def generate_leaf_graph(s):
 """
 Will generate a leaf graph and return it along
 with the Character dictionary representing the characters
 at each leaf node position
 """
 T = nx.DiGraph()
 Character = {}
 i = 0
 parI = len(s)
 for (son, daughter) in zip(s[0::2], s[1::2]):
   Character[i] = son
   Character[i+1] = daughter
   T.add_edge(parI, i)
   T.add_edge(parI, i+1)
   i += 2
   parI += 1</p>
<p>while count_predecessors(T) &gt; 1:
  for v in T.nodes():
   T.add_edge(parI, v)
   T.add_edge(parI, v+1)
   parI += 1
 return [T, Character]
 ```</p>
</article>

        <footer>
            <nav>
                <ul>
                    <li><a href="./pages/contact.html">Contact</a></li>
                    <li>:: <a href="./categories.html">Categories</a></li>
                </ul>
            </nav>
        </footer>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z9P3V6D0SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z9P3V6D0SV');
</script>
</body>
</html>