
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="./theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/github.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">




  <link href="https://shanedowling.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Shane Dowling Atom">

  <link href="https://shanedowling.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Shane Dowling RSS">

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'G-Z9P3V6D0SV', 'auto');
  ga('send', 'pageview');
</script>






 

<meta name="author" content="Shane Dowling" />
<meta name="description" content="PHP-Resque, the PHP equivalent to Ruby&#39;s really nice background process runner is a great way to execute long running PHP processes. Supervisor is a python-based process control system, essentially it&#39;s a convenient way to manage custom system processes you need to handle. Combining the two to manage long running PHP …" />
<meta name="keywords" content="">


  <meta property="og:site_name" content="Shane Dowling"/>
  <meta property="og:title" content="Manage background tasks with PHP-Resque and Supervisor"/>
  <meta property="og:description" content="PHP-Resque, the PHP equivalent to Ruby&#39;s really nice background process runner is a great way to execute long running PHP processes. Supervisor is a python-based process control system, essentially it&#39;s a convenient way to manage custom system processes you need to handle. Combining the two to manage long running PHP …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./manage-background-tasks-with-php-resque-and-supervisor-93d14234b703.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2014-07-03 00:00:00+00:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="./author/shane-dowling.html">
  <meta property="article:section" content="Tech"/>
  <meta property="og:image" content="/images/logo.png">

  <title>Shane Dowling &ndash; Manage background tasks with PHP-Resque and Supervisor</title>


</head>
<body class="light-theme">

<aside>
  <div>
    <a href="./">
      <img src="/images/logo.png" alt="Shane Dowling" title="Shane Dowling">
    </a>

    <h1>
      <a href="./">Shane Dowling</a>
    </h1>

    <p>Platform Engineering Manager</p>


    <nav>
      <ul class="list">


            <li>
              <a target="_self"
                 href="./pages/contact.html#contact">
                Contact
              </a>
            </li>

          <li>
            <a target="_self" href="https://platformengineeringmonthly.substack.com/" >newsletter</a>
          </li>
          <li>
            <a target="_self" href="https://sed.status.lol/" >statuslog</a>
          </li>
          <li>
            <a target="_self" href="https://now.sedd.dev/" >Now Page</a>
          </li>
      </ul>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-github"
           href="http://github.com/shano"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
      <li>
        <a class="sc-mastodon"
rel="me"           href="http://social.lol/@sed"
           target="_blank">
          <i class="fa-brands fa-mastodon"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/shanedow/"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="manage-background-tasks-with-php-resque-and-supervisor-93d14234b703">Manage background tasks with PHP-Resque and Supervisor</h1>
    <p>
      Posted on Thu 03 July 2014 in <a href="./category/tech.html">Tech</a>

    </p>
  </header>


  <div>
    <p><img alt="" src="images/1__DDS7CsAlPK7wTEEbPFLRAQ.jpeg"></p>
<p><a href="https://github.com/chrisboulton/php-resque">PHP-Resque</a>, the PHP equivalent to Ruby's really nice background process runner is a great way to execute long running PHP processes. <a href="http://supervisord.org/">Supervisor</a> is a python-based process control system, essentially it's a convenient way to manage custom system processes you need to handle. Combining the two to manage long running PHP jobs makes a lot of sense but it takes a little bit of work to get them talking.</p>
<p>Once you've gotten PHP-Resque <a href="https://github.com/chrisboulton/php-resque#getting-started">installed on your project</a>,
you've <a href="https://github.com/chrisboulton/php-resque#queueing-jobs">added items to your queue</a> and <a href="https://github.com/chrisboulton/php-resque#defining-jobs">written the workers to handle the background tasks</a>.
You'll need to plug PHP-Resque into supervisor. Here's a sample config
file I used to manage php resque queues within Yii projects but it
should work with anything that's using php-resque.</p>
<div class="highlight"><pre><span></span><code>[program:my_resque]
 directory=/var/www/website
 command=php vendor/chrisboulton/php-resque/bin/resque
 numprocs=2
 environment=QUEUE=&#39;myresquequeue&#39;,BLOCKING=1,COUNT=1,APP_INCLUDE=&#39;models/UsefulClasses.php&#39;
 autostart=true
 autorestart=true
 stopsignal=QUIT
 process_name = %(program_name)s-%(process_num)s
</code></pre></div>

<p>A few things to note.</p>
<ol>
<li>Firstly the APP_INCLUDE should include the set of classes you intent to use to handle the worker jobs. Meaning something that has a perform action that does something, as described <a href="https://github.com/chrisboulton/php-resque#defining-jobs">here</a>.</li>
<li>You'll notice the COUNT=1 argument being set in the resque environment. This is essential, if you fork more than one job using php-resque it'll background both and supervisor will not be able to manage that process(and will continually try to spawn more processes till it gives up). If you wish to have multiple workers, <strong>use the numprocs argument</strong>.</li>
</ol>
<p>And that's it really.</p>
<p>Happy forking!</p>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>






</article>

<footer>
<p>&copy;  </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Shane Dowling ",
  "url" : ".",
  "image": "/images/logo.png",
  "description": ""
}
</script>
</body>
</html>