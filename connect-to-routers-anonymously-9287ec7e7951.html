<!DOCTYPE html>
<html lang="en">
<head>
        <title>Shane Dowling : Connect to routers anonymously</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
        <link href="https://shanedowling.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Shane Dowling ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body>
        
<header>
    <h1><a href="." id="site-title">Shane Dowling </a> :
        <a href="./connect-to-routers-anonymously-9287ec7e7951.html" id="page-title">Connect to routers anonymously</a></h1>
<time datetime="2013-09-28T00:00:00+00:00">Sat 28 September 2013</time></header>
<article>
    <p><img alt="" src="images/1__2zYJ6QvnP__Z17B321DD7NQ.png"></p>
<p>I've created a little script that incorporates
<a href="https://launchpad.net/wicd">wicd</a>, <a href="https://github.com/alobbs/macchanger">macchanger</a>, <a href="http://unixhelp.ed.ac.uk/CGI/man-cgi?hostname">hostname</a> and <a href="http://www.openwall.com/john/">john the ripper's</a> password list to randomise your mac address and hostname when connecting to the internet.</p>
<p>I've gone with wicd over network manager as network-manager has a
tendency to store connection details, so while your machine might id
your hostname or mac address as something new, network-manager will
actually connect using the original stored details.</p>
<p>I must admit I enjoyed writing this, it reminded me of the old days when
linux network managers were all rubbish and you had to write bash
scripts to connect to vaguely complex network configurations.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="w"> </span><span class="c1"># Anonymise your machines internet connection</span>

<span class="c1"># Settings</span>
<span class="w"> </span><span class="nv">INTERFACE</span><span class="o">=</span>wlan1
<span class="w"> </span><span class="nv">HOSTS_FILE</span><span class="o">=</span><span class="s2">&quot;/etc/hosts&quot;</span>
<span class="w"> </span><span class="nv">START_TOKEN</span><span class="o">=</span><span class="s2">&quot;## start-anon&quot;</span>
<span class="w"> </span><span class="nv">END_TOKEN</span><span class="o">=</span><span class="s2">&quot;## end-anon&quot;</span>

<span class="c1"># Must be run as root</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$EUID</span><span class="w"> </span>-ne<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;This script must be run as root\\n&quot;</span><span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w"> </span><span class="k">fi</span>

<span class="c1"># Network restart function</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="s2">&quot;Linux&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="se">\`</span>uname<span class="se">\`</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="nv">restart_network</span><span class="o">=</span><span class="s2">&quot;/etc/init.d/networking restart&quot;</span>
<span class="w"> </span><span class="k">fi</span>

<span class="c1"># Function to clear old data and add new hosts entry</span>
<span class="w"> </span><span class="k">function</span><span class="w"> </span>update_hosts<span class="o">()</span>
<span class="w"> </span><span class="o">{</span>
<span class="w"> </span><span class="c1"># if no hosts file found…</span>
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span><span class="nv">$1</span><span class="w"> </span><span class="o">]</span>
<span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="se">\\</span>n<span class="s2">&quot;No hosts file found\\n&quot;</span><span class="w"> </span><span class="m">1</span>&gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w"> </span><span class="k">fi</span>

<span class="nv">file</span><span class="o">=</span><span class="nv">$1</span>
<span class="w"> </span><span class="nv">host</span><span class="o">=</span><span class="nv">$2</span>

<span class="nv">sed_script</span><span class="o">=</span><span class="s2">&quot;{</span>
<span class="s2"> s/</span><span class="nv">$END_TOKEN</span><span class="s2">/</span><span class="nv">$END_TOKEN</span><span class="s2">/</span>
<span class="s2"> t finished_sites</span>

<span class="s2">s/</span><span class="nv">$START_TOKEN</span><span class="s2">/</span><span class="nv">$START_TOKEN</span><span class="s2">/</span>
<span class="s2"> x</span>
<span class="s2"> t started_sites</span>

<span class="s2">s/</span><span class="nv">$START_TOKEN</span><span class="s2">/</span><span class="nv">$START_TOKEN</span><span class="s2">/</span>
<span class="s2"> x</span>
<span class="s2"> t started_sites</span>

<span class="s2">p</span>
<span class="s2"> b end</span>
<span class="s2"> : started_sites</span>
<span class="s2"> d</span>
<span class="s2"> : finished_sites</span>
<span class="s2"> x</span>
<span class="s2"> d</span>
<span class="s2"> : end</span>
<span class="s2"> d</span>
<span class="s2"> }&quot;</span>

hostname<span class="w"> </span><span class="nv">$host</span>

sed<span class="w"> </span>—<span class="w"> </span><span class="k">in</span>-place<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$sed_script</span><span class="s2">&quot;</span><span class="w"> </span><span class="nv">$file</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$START_TOKEN</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$file</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;\\n127.0.1.1 </span><span class="nv">$host</span><span class="s2">\\n&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$file</span>
<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$END_TOKEN</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$file</span>
<span class="w"> </span><span class="o">}</span>

<span class="c1"># Presenting original information</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;Starting to anonimise your data\\n&quot;</span>

<span class="c1"># Stop Wicd</span>
<span class="w"> </span>sudo<span class="w"> </span>service<span class="w"> </span>wicd<span class="w"> </span>stop
<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>

<span class="c1">#changing mac address to random</span>
<span class="w"> </span>ifconfig<span class="w"> </span><span class="nv">$INTERFACE</span><span class="w"> </span>down<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="o">[</span><span class="w"> </span><span class="nv">$?</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%snChanging mac address…\\n&quot;</span>
<span class="w"> </span>macchanger<span class="w"> </span>-r<span class="w"> </span><span class="nv">$INTERFACE</span>
<span class="w"> </span><span class="k">else</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%sScript encountered an error, sorry…\\n&quot;</span>
<span class="w"> </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
<span class="w"> </span><span class="k">fi</span>
<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>

<span class="c1"># Use john to supply new hostname to function</span>
<span class="w"> </span><span class="nv">OLDHOST</span><span class="o">=</span><span class="k">$(</span>hostname<span class="k">)</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;%s\\nChanging hostname…\\n&quot;</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;Current : </span><span class="nv">$OLDHOST</span><span class="s2"> \\n&quot;</span>
<span class="w"> </span><span class="nv">FILE</span><span class="o">=</span>/usr/share/john/password.lst
<span class="w"> </span><span class="nv">WORD</span><span class="o">=</span><span class="k">$(</span>sort<span class="w"> </span>-R<span class="w"> </span><span class="nv">$FILE</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-1<span class="k">)</span>
<span class="w"> </span>update_hosts<span class="w"> </span><span class="nv">$HOSTS_FILE</span><span class="w"> </span><span class="nv">$WORD</span>
<span class="w"> </span><span class="nv">NEWHOST</span><span class="o">=</span><span class="k">$(</span>hostname<span class="k">)</span>
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;New : </span><span class="nv">$NEWHOST</span><span class="s2"> \\n&quot;</span>
<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>

<span class="c1"># putting interface up</span>
<span class="w"> </span>ifconfig<span class="w"> </span><span class="nv">$INTERFACE</span><span class="w"> </span>up<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;\\n&quot;</span>
<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>

<span class="c1"># Restart networking</span>
<span class="w"> </span><span class="nv">$restart_network</span>

<span class="c1"># Get wicd back up and running</span>
<span class="w"> </span>service<span class="w"> </span>wicd<span class="w"> </span>start
<span class="w"> </span>sleep<span class="w"> </span><span class="m">1</span>

wicd-gtk<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">&amp;</span>
</code></pre></div>
</article>

        <footer>
            <nav>
                <ul>
                    <li><a href="./pages/contact.html">Contact</a></li>
                    <li>:: <a href="./categories.html">Categories</a></li>
                </ul>
            </nav>
        </footer>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z9P3V6D0SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z9P3V6D0SV');
</script>
</body>
</html>