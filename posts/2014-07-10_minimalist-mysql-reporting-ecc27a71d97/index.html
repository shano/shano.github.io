<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Minimalist MySQL Reporting | Shane Dowling</title><meta name=keywords content><meta name=description content="
Sometimes business folk can have crazy demands on the types of reports
your system should produce and sometimes these can be really time
consuming and painful to get right. Often I find the most flexible
solution is to give these power-users access to tidier version of the
raw data within a tool they&rsquo;re comfortable playing with themselves.
To that end, Excel has a serviceable ODBC connector
that costs $35 and will allow your power users to pull data in from
MySQL and filter/play around to their hearts content. The problem is a)
formatting the data in such a way to provide useful information to your
users and b) opening up data access just enough to allow these reporting
users into your system."><meta name=author content="Shane Dowling"><link rel=canonical href=https://shanedowling.com/posts/2014-07-10_minimalist-mysql-reporting-ecc27a71d97/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://shanedowling.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shanedowling.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shanedowling.com/favicon-32x32.png><link rel=apple-touch-icon href=https://shanedowling.com/apple-touch-icon.png><link rel=mask-icon href=https://shanedowling.com/favicon.ico><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://shanedowling.com/posts/2014-07-10_minimalist-mysql-reporting-ecc27a71d97/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://shanedowling.com/posts/2014-07-10_minimalist-mysql-reporting-ecc27a71d97/"><meta property="og:site_name" content="Shane Dowling"><meta property="og:title" content="Minimalist MySQL Reporting"><meta property="og:description" content="
Sometimes business folk can have crazy demands on the types of reports your system should produce and sometimes these can be really time consuming and painful to get right. Often I find the most flexible solution is to give these power-users access to tidier version of the raw data within a tool they’re comfortable playing with themselves.
To that end, Excel has a serviceable ODBC connector that costs $35 and will allow your power users to pull data in from MySQL and filter/play around to their hearts content. The problem is a) formatting the data in such a way to provide useful information to your users and b) opening up data access just enough to allow these reporting users into your system."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-07-10T00:00:00+00:00"><meta property="article:modified_time" content="2014-07-10T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Minimalist MySQL Reporting"><meta name=twitter:description content="
Sometimes business folk can have crazy demands on the types of reports
your system should produce and sometimes these can be really time
consuming and painful to get right. Often I find the most flexible
solution is to give these power-users access to tidier version of the
raw data within a tool they&rsquo;re comfortable playing with themselves.
To that end, Excel has a serviceable ODBC connector
that costs $35 and will allow your power users to pull data in from
MySQL and filter/play around to their hearts content. The problem is a)
formatting the data in such a way to provide useful information to your
users and b) opening up data access just enough to allow these reporting
users into your system."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://shanedowling.com/posts/"},{"@type":"ListItem","position":2,"name":"Minimalist MySQL Reporting","item":"https://shanedowling.com/posts/2014-07-10_minimalist-mysql-reporting-ecc27a71d97/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Minimalist MySQL Reporting","name":"Minimalist MySQL Reporting","description":"\nSometimes business folk can have crazy demands on the types of reports your system should produce and sometimes these can be really time consuming and painful to get right. Often I find the most flexible solution is to give these power-users access to tidier version of the raw data within a tool they\u0026rsquo;re comfortable playing with themselves.\nTo that end, Excel has a serviceable ODBC connector that costs $35 and will allow your power users to pull data in from MySQL and filter/play around to their hearts content. The problem is a) formatting the data in such a way to provide useful information to your users and b) opening up data access just enough to allow these reporting users into your system.\n","keywords":[],"articleBody":"\nSometimes business folk can have crazy demands on the types of reports your system should produce and sometimes these can be really time consuming and painful to get right. Often I find the most flexible solution is to give these power-users access to tidier version of the raw data within a tool they’re comfortable playing with themselves.\nTo that end, Excel has a serviceable ODBC connector that costs $35 and will allow your power users to pull data in from MySQL and filter/play around to their hearts content. The problem is a) formatting the data in such a way to provide useful information to your users and b) opening up data access just enough to allow these reporting users into your system.\nA) Formatting the data The easiest way to format data in MySQL is to create a view, these are not difficult to setup. You simply need to wrap some simple syntax around the query you wish to run. So build the query that returns the\nCREATE VIEW view_name AS SELECT column_name(s) FROM table_name WHERE condition One thing to note is that the ODBC connector won’t render BLOB data, so to handle this use\nSELECT (CONVERT field utf8) FROM table; to convert it to a readable format.\nB) Opening up data access Step 1: By changing the bind-address from 127.0.0.1 to 0.0.0.0 in /etc/mysql/my.cnf this opens MySQL for remote connections. A better alternative to this could be to keep MySQL closed and tunnel the connections over SSH, this can be done with Putty on Windows or just run ssh -ND user@remoteserver to setup a proxy.\nStep 2: If you decide to open MySQL to the outside world I strongly recommend using a firewall to restrict access to the port. On ubuntu to open up the firewall to allow connections to port 3306 from your office ip just run this command.\nsudo ufw allow from yourip to any port 3306\nStep 3: Now create the remote user.\nCREATE USER 'reportUser'@'yourip' IDENTIFIED BY 'yourpassword'; Step 4: Granting access to only a view for users on your IP.\nGRANT SELECT ON database.view_name TO 'reportUser'@'yourip'; FLUSH PRIVILEGES Step 5: Simply point the ODBC Excel connector to your MySQL host and have it run the query\nSELECT * FROM database.view_name and the result set should populate in Excel.\nOne final key thing to note is that it’s a very dangerous thing to allow reporting users to hit live databases, they could really kill the system for live users. Ideally, you would do all of this on a replicated MySQL server that only allows read-only actions against it, like backups and reporting.\n","wordCount":"437","inLanguage":"en","datePublished":"2014-07-10T00:00:00Z","dateModified":"2014-07-10T00:00:00Z","author":{"@type":"Person","name":"Shane Dowling"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shanedowling.com/posts/2014-07-10_minimalist-mysql-reporting-ecc27a71d97/"},"publisher":{"@type":"Organization","name":"Shane Dowling","logo":{"@type":"ImageObject","url":"https://shanedowling.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://shanedowling.com/ accesskey=h title="Shane Dowling (Alt + H)">Shane Dowling</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://shanedowling.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://shanedowling.com/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Minimalist MySQL Reporting</h1><div class=post-meta><span title='2014-07-10 00:00:00 +0000 UTC'>July 10, 2014</span>&nbsp;·&nbsp;Shane Dowling</div></header><div class=post-content><p><img loading=lazy src=/1__ehZIxeK7e1vIcDgZbwxgXQ.jpeg></p><p>Sometimes business folk can have crazy demands on the types of reports
your system should produce and sometimes these can be really time
consuming and painful to get right. Often I find the most flexible
solution is to give these power-users access to tidier version of the
raw data within a tool they&rsquo;re comfortable playing with themselves.</p><p>To that end, Excel has a <a href=http://www.actualtech.com/product_opensourcedatabases.php>serviceable ODBC connector</a>
that costs $35 and will allow your power users to pull data in from
MySQL and filter/play around to their hearts content. The problem is a)
formatting the data in such a way to provide useful information to your
users and b) opening up data access just enough to allow these reporting
users into your system.</p><h3 id=a-formatting-the-data>A) Formatting the data<a hidden class=anchor aria-hidden=true href=#a-formatting-the-data>#</a></h3><p>The easiest way to format data in MySQL is to create a view, these are
not difficult to setup. You simply need to wrap some simple syntax
around the query you wish to run. So build the query that returns the</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>VIEW</span> view_name <span style=color:#66d9ef>AS</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span> <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>WHERE</span> condition
</span></span></code></pre></div><p>One thing to note is that the ODBC connector won&rsquo;t render BLOB data, so
to handle this use</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> (<span style=color:#66d9ef>CONVERT</span> field utf8) <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table</span>;
</span></span></code></pre></div><p>to convert it to a readable format.</p><h3 id=b-opening-up-data-access>B) Opening up data access<a hidden class=anchor aria-hidden=true href=#b-opening-up-data-access>#</a></h3><p><strong>Step 1:</strong> By changing the bind-address from 127.0.0.1 to 0.0.0.0 in
/etc/mysql/my.cnf this opens MySQL for remote connections. A better
alternative to this could be to keep MySQL closed and tunnel the
connections over SSH, this can be done with Putty on Windows or just run
ssh -ND user@remoteserver to setup a proxy.</p><p><strong>Step 2:</strong> If you decide to open MySQL to the outside world I
strongly recommend using a firewall to restrict access to the port. On
ubuntu to open up the firewall to allow connections to port 3306
from your office ip just run this command.</p><p>sudo ufw allow from yourip to any port 3306</p><p><strong>Step 3:</strong> Now create the remote user.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;reportUser&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;yourip&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;yourpassword&#39;</span>;
</span></span></code></pre></div><p><strong>Step 4:</strong> Granting access to only a view for users on your IP.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>ON</span> <span style=color:#66d9ef>database</span>.view_name <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;reportUser&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;yourip&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FLUSH <span style=color:#66d9ef>PRIVILEGES</span>
</span></span></code></pre></div><p><strong>Step 5:</strong> Simply point the ODBC Excel connector to your MySQL host
and have it run the query</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>database</span>.view_name
</span></span></code></pre></div><p>and the result set should populate in Excel.</p><p>One final key thing to note is that it&rsquo;s a very dangerous thing to allow
reporting users to hit live databases, they could really kill the system
for live users. Ideally, you would do all of this on a replicated MySQL
server that only allows read-only actions against it, like backups and
reporting.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://shanedowling.com/>Shane Dowling</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>