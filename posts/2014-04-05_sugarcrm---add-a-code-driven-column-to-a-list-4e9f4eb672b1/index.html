<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=8080&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="noindex, nofollow"><title>SugarCRM — Add a code-driven column to a list | Shane Dowling</title><meta name=keywords content><meta name=description content="Sometimes you might find that you want your users to make decisions based on ListViews and you need to pull in relational data beyond the immediately related objects. Example
So using the circus example say you have performers who are performing for a specific show. You might want to see what other shows those performers are also attached to. If it&rsquo;s typically only one or two shows per event, you can probably make another column in the ListView that displays all shows related to that performer. Lets call this field &lsquo;Other Shows&rsquo;."><meta name=author content="Shane Dowling"><link rel=canonical href=http://localhost:8080/posts/2014-04-05_sugarcrm---add-a-code-driven-column-to-a-list-4e9f4eb672b1/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:8080/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:8080/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:8080/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:8080/apple-touch-icon.png><link rel=mask-icon href=http://localhost:8080/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:8080/posts/2014-04-05_sugarcrm---add-a-code-driven-column-to-a-list-4e9f4eb672b1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:8080/ accesskey=h title="Shane Dowling (Alt + H)">Shane Dowling</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:8080/posts/ title=Posts><span>Posts</span></a></li><li><a href=http://localhost:8080/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">SugarCRM — Add a code-driven column to a list</h1><div class=post-meta><span title='2014-04-05 00:00:00 +0000 UTC'>April 5, 2014</span>&nbsp;·&nbsp;Shane Dowling</div></header><div class=post-content><p>Sometimes you might find that you want your users to make decisions based on ListViews and you need to pull in relational data beyond the immediately related objects. Example</p><p>So using the circus example say you have performers who are performing for a specific show. You might want to see what other shows those performers are also attached to. If it&rsquo;s typically only one or two shows per event, you can probably make another column in the ListView that displays all shows related to that performer. Lets call this field &lsquo;Other Shows&rsquo;.</p><p>What to do
-—-— —</p><p>Add your new field in studio before you do anything. So fire up Studio
and create an &lsquo;Other Shows&rsquo; field, create this as a text field.</p><p>Alter the newly created fields vardef and set it to non-db.</p><p>You can typically find it in
custom/Extension/modules/Performers/Ext/Vardefs/other_shows_c.php.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span>$dictionary[<span style=color:#e6db74>&#39;Performers&#39;</span>][<span style=color:#e6db74>&#39;fields&#39;</span>][<span style=color:#e6db74>&#39;other_shows_c&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>array</span>(
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;name&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;other_shows_c&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;vname&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;LBL_OTHER_SHOWS_C&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;type&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;varchar&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;len&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;255&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;source&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;non-db&#39;</span>
</span></span><span style=display:flex><span> );
</span></span></code></pre></div><p>Ensure the field isn&rsquo;t sortable..</p><p>Trying to sort a db/non-db field will cause a bit of trouble and
ListViews don&rsquo;t support it, so just disable it.</p><p>Under custom/modules/Performers/metadata/listviewdefs.php change your
newly created fields definition.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#e6db74>&#39;OTHER_SHOWS_C&#39;</span> <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>array</span> (
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;label&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;Other Shows&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;width&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#e6db74>&#39;10%&#39;</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;default&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#39;sortable&#39;</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span> ),
</span></span></code></pre></div><p>Adding the actual code to run.</p><p>For this we&rsquo;re going to leverage SugarCRM&rsquo;s logic hooks. If you haven&rsquo;t
already create a logic_hooks.php under custom/modules/Performers/ with
contents like this.</p><p>This file essentially defines the hooks you&rsquo;re going to call. The hook
process_record means it&rsquo;ll be called for every row that&rsquo;s displayed on
the ListView.</p><p>The performers_logic_hooks_class.php file will be included,
performers_logic_hooks is the class that it will look for and
list_record_process is the function within that class that it will
call.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Do not store anything in this file that is not part of the array or the hook version. This file will
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> <span style=color:#75715e>// be automatically rebuilt in the future.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> $hook_version <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span> $hook_array <span style=color:#f92672>=</span> <span style=color:#66d9ef>Array</span>();
</span></span><span style=display:flex><span> <span style=color:#75715e>// position, file, function
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> $hook_array[<span style=color:#e6db74>&#39;before_save&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>Array</span>();
</span></span><span style=display:flex><span> $hook_array[<span style=color:#e6db74>&#39;before_save&#39;</span>][] <span style=color:#f92672>=</span> <span style=color:#66d9ef>Array</span>(<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;workflow&#39;</span>, <span style=color:#e6db74>&#39;include/workflow/WorkFlowHandler.php&#39;</span>,<span style=color:#e6db74>&#39;WorkFlowHandler&#39;</span>, <span style=color:#e6db74>&#39;WorkFlowHandler&#39;</span>);
</span></span><span style=display:flex><span> $hook_array[<span style=color:#e6db74>&#39;process_record&#39;</span>][] <span style=color:#f92672>=</span> <span style=color:#66d9ef>Array</span>(<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;Other_Shows&#39;</span>, <span style=color:#e6db74>&#39;custom/modules/Performers/performers_logic_hooks.php&#39;</span>,<span style=color:#e6db74>&#39;performers_logic_hooks&#39;</span>, <span style=color:#e6db74>&#39;list_record_process&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>Define the class.</p><p>Don&rsquo;t name the class something generic, like logic_hook_class and use
that class name everywhere. It&rsquo;ll cause a bunch of conflicts when it
comes to saving related data, hence the name performers_logic_hooks.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>performers_logic_hooks</span>
</span></span><span style=display:flex><span> {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>/**
</span></span></span><span style=display:flex><span><span style=color:#e6db74> * Called as process_record logic hook on the Performers module
</span></span></span><span style=display:flex><span><span style=color:#e6db74> */</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>list_record_process</span>($bean, $event, $arguments)
</span></span><span style=display:flex><span> {
</span></span><span style=display:flex><span> <span style=color:#75715e>//Do some code to get the related shows for the performer and store in the $other_shows variable
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>$this<span style=color:#f92672>-&gt;</span><span style=color:#a6e22e>other_shows_c</span> <span style=color:#f92672>=</span> $other_shows;
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Add the field to your listview via studio and do a quick repair/rebuild.
That should hopefully be it.</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:8080/>Shane Dowling</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>