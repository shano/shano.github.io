<!DOCTYPE html>
<html lang="en">
<head>
        <title>Quick vhost script</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css" />
        <link rel="stylesheet" href="./theme/css/main.css" />
        <link href="https://shanedowling.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Shane Dowling Full Atom Feed" />
        <link href="https://shanedowling.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Shane Dowling Full RSS Feed" />
        <link href="https://shanedowling.com/feeds/category.slug.atom.xml" type="application/atom+xml" rel="alternate" title="Shane Dowling Categories Atom Feed" />
        <link href="https://shanedowling.com/feeds/category.slug.rss.xml" type="application/rss+xml" rel="alternate" title="Shane Dowling Categories RSS Feed" />
</head>
<body>

    <div class="main-nav-container">

        <div class="pure-g">
            <div class="pure-u-1 pure-u-lg-2-3">
                <div class="main-nav">
                    <ul class="main-nav-list">
                        <li class="main-nav-item"><a href="./" class="pure-menu-link">Shane Dowling</a></li>

                        <li class="main-nav-item"><a href="./category/til.html" class="pure-menu-link">TIL</a></li>
                        <li class="main-nav-item active"><a href="./category/tech.html" class="pure-menu-link">Tech</a></li>
                        <li class="main-nav-item"><a href="./category/random.html" class="pure-menu-link">random</a></li>
                        <li class="main-nav-item"><a href="./category/productivity.html" class="pure-menu-link">Productivity</a></li>
                        <li class="main-nav-item"><a href="./category/posts.html" class="pure-menu-link">posts</a></li>
                        <li class="main-nav-item"><a href="./category/mindfulness.html" class="pure-menu-link">Mindfulness</a></li>
                        <li class="main-nav-item"><a href="./category/digital-minimalism.html" class="pure-menu-link">Digital Minimalism</a></li>
                    </ul>
                </div>
             </div>

             <div class="pure-u-1 pure-u-lg-1-3"></div>
        </div>

    </div>


<div class="page-container">
    <div class="entry-content">
        <div class="post-meta pure-g">
            <div class="pure-u-3-4 meta-data">
                <a href="./category/tech.html" class="category">Tech</a><br />

                <a class="author" href="./author/shane-dowling.html">Shane Dowling</a>
                &mdash; <abbr title="2012-03-01T00:00:00+00:00">Thu 01 March 2012</abbr>
            </div>
        </div>
    </div>

    <div class="article-header-container">
        <div class="background-image-container">

            <div class="background-image-small">
                <div class="title-container">
                    <h1>Quick vhost script</h1>
                </div>
            </div>
        </div>
    </div>

    <div class="entry-content">
        <p>Quick script to setup a new virtualhost entry for apache. Works for me
on archlinux.</p>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python</span>
 <span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">subprocess</span>

<span class="n">vhosts_file</span> <span class="o">=</span> <span class="err">“</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">extra</span><span class="o">/</span><span class="n">httpd</span><span class="o">-</span><span class="n">vhosts</span><span class="o">.</span><span class="n">conf</span><span class="err">”</span>
 <span class="n">hosts_file</span> <span class="o">=</span> <span class="err">“</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span><span class="err">”</span>

<span class="n">domain_name</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 <span class="n">folder</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">):</span>
 <span class="n">usage</span><span class="p">()</span>
 <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="n">currentUser</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">getoutput</span><span class="p">(</span><span class="err">“</span><span class="n">whoami</span><span class="err">”</span><span class="p">)</span>
 <span class="k">if</span> <span class="n">currentUser</span> <span class="o">!=</span> <span class="err">‘</span><span class="n">root</span><span class="err">’</span><span class="p">:</span>
 <span class="nb">print</span><span class="p">(</span><span class="err">“</span><span class="n">You</span> <span class="n">need</span> <span class="n">to</span> <span class="n">be</span> <span class="n">root</span><span class="err">!”</span><span class="p">)</span>
 <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">vhosts_file</span><span class="p">):</span>
 <span class="nb">print</span><span class="p">(</span><span class="err">“</span><span class="n">Vhosts</span> <span class="n">file</span> <span class="n">doesn</span><span class="err">’</span><span class="n">t</span> <span class="n">exist</span><span class="p">,</span> <span class="n">exiting</span><span class="err">”</span><span class="p">)</span>
 <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">hosts_file</span><span class="p">):</span>
 <span class="nb">print</span><span class="p">(</span><span class="err">“</span><span class="n">Hosts</span> <span class="n">file</span> <span class="n">doesn</span><span class="err">’</span><span class="n">t</span> <span class="n">exist</span><span class="p">,</span> <span class="n">exiting</span><span class="err">”</span><span class="p">)</span>
 <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
 <span class="nb">print</span><span class="p">(</span><span class="err">“</span><span class="n">Web</span> <span class="n">folder</span> <span class="n">doesn</span><span class="err">’</span><span class="n">t</span> <span class="n">exist</span><span class="p">,</span> <span class="n">attempting</span> <span class="n">to</span> <span class="n">create</span><span class="err">”</span><span class="p">)</span>
 <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>

<span class="n">vhost_entry</span> <span class="o">=</span> <span class="err">“</span><span class="n">nnntServerAdmin</span> <span class="n">your</span><span class="o">@%</span><span class="n">sntDocumentRoot</span> <span class="err">“</span><span class="o">%</span><span class="n">s</span><span class="err">”</span><span class="n">ntServerName</span> <span class="o">%</span><span class="n">sntServerAlias</span> <span class="o">%</span><span class="n">s</span> <span class="n">ntnttDirectoryIndex</span> <span class="n">index</span><span class="o">.</span><span class="n">php</span> <span class="n">index</span><span class="o">.</span><span class="n">htm</span> <span class="n">index</span><span class="o">.</span><span class="n">htmlnttAddHandler</span> <span class="n">cgi</span><span class="o">-</span><span class="n">script</span> <span class="o">.</span><span class="n">cgi</span> <span class="o">.</span><span class="n">plnttOptions</span> <span class="n">ExecCGI</span> <span class="n">Indexes</span> <span class="n">FollowSymLinks</span> <span class="n">MultiViews</span> <span class="o">+</span><span class="n">IncludesnttAllowOverride</span> <span class="n">NonenttOrder</span> <span class="n">allow</span><span class="p">,</span><span class="n">denynttallow</span> <span class="kn">from</span> <span class="nn">allntn</span><span class="err">”</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_name</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">domain_name</span><span class="p">,</span> <span class="n">domain_name</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span>

<span class="n">vhosts_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">vhost_entry</span><span class="p">)</span>

<span class="n">host_entry</span> <span class="o">=</span> <span class="err">“</span><span class="n">n127</span><span class="o">.</span><span class="mf">0.0</span><span class="o">.</span><span class="mi">1</span> <span class="o">%</span><span class="n">sn</span><span class="err">”</span> <span class="o">%</span> <span class="n">domain_name</span>

<span class="n">vhosts_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">host_entry</span><span class="p">)</span>

<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="err">‘</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">httpd</span> <span class="n">restart</span><span class="err">’</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
    </div>

    <footer>
        <div class="pure-g post-footer">
            <div class="pure-u-1 pure-u-md-1-2">
                <div class="pure-g poster-info">
                    <div class="pure-u-3-4">
                        <h3 class="author-name"><a href="./author/shane-dowling.html">Shane Dowling</a></h3>
                        <p class="author-description">
                        </p>
                    </div>
                </div>
            </div>



        </div>


    </footer>


</div>


</body>
</html>