<!DOCTYPE html>
<html lang="en">
<head>
        <title>Shane Dowling : Suppling test data to django-cities</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
        <link href="https://shanedowling.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Shane Dowling ATOM Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body>
        
<header>
    <h1><a href="." id="site-title">Shane Dowling </a> :
        <a href="./suppling-test-data-to-django-cities-6afd013f671d.html" id="page-title">Suppling test data to django-cities</a></h1>
<time datetime="2013-08-29T00:00:00+00:00">Thu 29 August 2013</time></header>
<article>
    <p><a href="https://github.com/coderholic/django-cities">Django-Cities</a>, is an awesome project that supplies easy to import worldwide location data and a set of very neat location models that you should really be using for any django project needing location information. I've been using it lately but ran into problems when I tried to run unit tests that made use of the django-cities app.</p>
<p>As django-cities populates a load of data via it's import command it can
take a long time(over an hour) before a test database with all the data
could be created. So I needed a stop-gap solution to quickly get a
workable dataset up and running for a few small unit tests.</p>
<p>I find fixtures problematic, data may change over time and maintaining a
bunch of JSON files to represent a few simple locations can be a pain.
So here's a very quick example of how I use the ORM to populate a single
location hierarchy for your tests.py.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="n">Country</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;United Kingdom&quot;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="n">tld</span><span class="o">=</span><span class="s1">&#39;co.uk&#39;</span><span class="p">,</span> <span class="n">population</span> <span class="o">=</span> <span class="mi">62740000</span><span class="p">)</span>
 <span class="bp">self</span><span class="o">.</span><span class="n">country</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">Region</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;London&quot;</span><span class="p">,</span> <span class="n">name_std</span><span class="o">=</span><span class="s2">&quot;London&quot;</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="s2">&quot;LDN&quot;</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country</span><span class="p">)</span>
 <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

  <span class="bp">self</span><span class="o">.</span><span class="n">city</span> <span class="o">=</span> <span class="n">City</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Camden&#39;</span><span class="p">,</span> <span class="n">name_std</span><span class="o">=</span><span class="s1">&#39;Camden&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">country</span><span class="p">,</span> <span class="n">population</span> <span class="o">=</span> <span class="mi">8174000</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;POINT (3400000 6700010)&#39;</span><span class="p">)</span>
   <span class="bp">self</span><span class="o">.</span><span class="n">city</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div>

<p>The city POINT location is totally random, I'll start populating real
location values when I need distance based tests.</p>
</article>

        <footer>
            <nav>
                <ul>
                    <li><a href="./pages/contact.html">Contact</a></li>
                    <li>:: <a href="./categories.html">Categories</a></li>
                </ul>
            </nav>
        </footer>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Z9P3V6D0SV"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-Z9P3V6D0SV');
</script>
</body>
</html>